<div class="w-full h-full flex flex-col">
  <div class="w-full flex justify-end gap-2 p-2 bg-blue-50 border-b border-blue-100 rounded-t-xl">
    @if (generatedOutput() && !generatedOutput()?.isJson && generatedOutput()?.htmlContent) {
      <button (click)="downloadHtml()" class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition duration-200 ease-in-out shadow-sm">
        Download HTML
      </button>
    } @else if (generatedOutput() && generatedOutput()?.isJson && generatedOutput()?.htmlContent) {
      <button (click)="downloadHtml()" class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 transition duration-200 ease-in-out shadow-sm">
        Download JSON
      </button>
    }
  </div>
  <div class="flex-grow w-full h-[calc(100%-48px)] bg-gray-100 rounded-b-xl overflow-hidden border border-blue-100">
    @if (sanitizedContentUrl()) {
      <iframe [src]="sanitizedContentUrl()!" class="w-full h-full border-none"></iframe>
    } @else {
      <div class="flex items-center justify-center h-full text-gray-500 text-lg">
        <p>Waiting for website content...</p>
      </div>
    }
  </div>

  @if (generatedOutput()?.groundingUrls?.length) {
    <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200 shadow-sm text-sm" appScrollAnimation>
      <h3 class="font-semibold text-blue-700 mb-2">Sources (Google Search Grounding):</h3>
      <ul class="list-disc list-inside space-y-1 text-gray-700">
        @for (url of generatedOutput()!.groundingUrls; track url.uri) {
          <li>
            <a [href]="url.uri" target="_blank" class="text-blue-600 hover:underline hover:text-blue-800 transition duration-200 ease-in-out">
              {{ url.title || url.uri }}
            </a>
          </li>
        }
      </ul>
    </div>
  }
</div>